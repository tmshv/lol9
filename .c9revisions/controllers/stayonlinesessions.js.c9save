{"ts":1350484230724,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":true,"ts":1350484232060,"patch":[[{"diffs":[[1,"exports.savesession = function(user_id, callback){\n\n    global.db.collection('stayonlinesessions', function(err, collection) {\n        if (err){\n            callback(true);\n            return;\n        }\n        var hash = global.controllers.db.criptpassword(user_id.toString());\n        collection.insert({user_id: user_id, hash: hash, createdate: new Date()},{safe:true},function(error, result){\n            if (err){\n                callback(true);\n                return;\n            }   \n            callback(false, hash);\n        });\n    });    \n};\n\nexports.getsession = function(hash, callback){\n    global.db.collection('stayonlinesessions', function(err, collection) {\n        if (err){\n            callback(true);\n            return;\n        }\n        collection.findOne({hash: hash}, function(error,item){\n            if (err || item === null){\n                callback(true);\n                return;\n            }   \n            global.controllers.users.getuser(item.user_id, function(error, user){\n                if (err || user === null){\n                    callback(true);\n                    return;\n                }\n                callback(false, user);\n            });\n        });        \n    });   \n};\n\nexports.delsession = function(hash, callback){\n    global.db.collection('stayonlinesessions', function(err, collection) {\n        if (err){\n            callback(true);\n            return;\n        }        \n        collection.remove({hash: hash}, {safe: true}, function(err,removed){\n            if (err || !removed){\n                callback(true);\n                return;\n            }   \n            callback(false);\n        });        \n    }); \n};"]],"start1":0,"start2":0,"length1":0,"length2":1675}]],"length":1675,"saved":false}
