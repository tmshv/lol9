{"ts":1350484177493,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":true,"ts":1350484179013,"patch":[[{"diffs":[[1,"exports.register = function(email, password, callback){\n    global.db.collection('users', function(err, collection) {\n        if (err){\n            callback(true);\n            return;\n        }\n        collection.findOne({email: email.toLowerCase()}, function(eror, item){\n            if (item === null){\n                collection.insert({email: email.toLowerCase(), password: global.controllers.db.criptpassword(password), emailchack: true, roles: []},{safe:true},function(error, result){\n                    if (err){\n                        callback(true);\n                        return;\n                    }   \n                    callback(false, result[0]);\n                });\n            }else  callback(true, null, 'User already exists');    \n            \n        });\n    });     \n};"]],"start1":0,"start2":0,"length1":0,"length2":794}]],"length":794,"saved":false}
{"ts":1350484187746,"patch":[[{"diffs":[[0,"     \n};"],[1,"\n\nexports.getuser = function(id, callback){\n    global.db.collection('users', function(err, collection) {\n        if (err){\n            callback(true);\n            return;\n        }\n        var ObjectID = require('mongodb').ObjectID;\n        if (typeof id === 'string') id = new ObjectID(id);\n        collection.findOne({_id: id}, function(eror, item){\n            if (err){\n                callback(true);\n                return;\n            }    \n            callback(false, item);\n        });\n    });\n};\n"]],"start1":786,"start2":786,"length1":8,"length2":515}]],"length":1301,"saved":false}
{"ts":1350484198096,"patch":[[{"diffs":[[0,"\n    });\n};\n"],[1,"\nexports.checkuser = function(email, password, callback){\n\n    global.db.collection('users', function(err, collection) {\n        if (err){\n            callback(true);\n            return;\n        }\n        collection.findOne({email: email.toLowerCase(), password: global.controllers.db.criptpassword(password)}, function(error,item){\n            if (item === null) item = {};\n            callback(error, item.emailchack, item);    \n        });\n    });    \n};"]],"start1":1289,"start2":1289,"length1":12,"length2":469}]],"length":1758,"saved":false}
